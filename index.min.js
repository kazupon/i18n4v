!function(t,n,e){"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define(t,e):n[t]=e()}("i18n",this,function(){"use strict";function t(){this.data={values:{},contexts:[]},this.globalContext={},this.localStorage=null}var n=function(){if("undefined"==typeof navigator)return!1;var t=navigator.userAgent.toLowerCase();return t.indexOf("msie")!==-1&&parseInt(t.split("msie")[1])<9}();t.prototype.translate=function(t,n,e,r,a){var o,l,i;null==a&&(a=this.globalContext);var u=function(t){var n=typeof t;return"function"===n||"object"===n&&!!t};return u(n)?(o=null,i=null,l=n,a=e||this.globalContext):"number"==typeof n?(o=null,i=n,l=e,a=r||this.globalContext):(o=n,"number"==typeof e?(i=e,l=r):(i=null,l=e,a=r||this.globalContext)),u(t)?(u(t.i18n)&&(t=t.i18n),this.translateHash(t,a)):this.translateText(t,i,l,a,o)},t.prototype.add=function(t){if(null!=t.values){var n=t.values;for(var e in n)this.data.values[e]=n[e]}if(null!=t.contexts){for(var r=t.contexts,a=[],o=0,l=r.length;o<l;o++)a.push(this.data.contexts.push(r[o]));return a}},t.prototype.setContext=function(t,n){return this.globalContext[t]=n},t.prototype.clearContext=function(t){return this.globalContext[t]=null},t.prototype.reset=function(){return this.resetData(),this.resetContext()},t.prototype.resetData=function(){return this.data={values:{},contexts:[]}},t.prototype.resetContext=function(){return this.globalContext={}},t.prototype.translateHash=function(t,n){for(var e in t){var r=t[e];"string"==typeof r&&(t[e]=this.translateText(r,null,null,n))}return t},t.prototype.translateText=function(t,n,e,r,a){var o;if(null==r&&(r=this.globalContext),null==this.data)return this.useOriginalText(a||t,n,e);var l=this.getContextData(this.data,r);return null!=l&&(o=this.findTranslation(t,n,e,l.values,a)),null==o&&(o=this.findTranslation(t,n,e,this.data.values,a)),null==o?this.useOriginalText(a||t,n,e):o},t.prototype.findTranslation=function(t,n,e,r){var a=r[t];if(null==a)return null;if(null==n){if("string"==typeof a)return this.applyFormatting(a,n,e)}else if(a instanceof Array||a.length)for(var o=0,l=a.length;o<l;o++){var i=a[o];if((n>=i[0]||null===i[0])&&(n<=i[1]||null===i[1])){var u=this.applyFormatting(i[2].replace("-%n",String(-n)),n,e);return this.applyFormatting(u.replace("%n",String(n)),n,e)}}return null},t.prototype.getContextData=function(t,n){if(null==t.contexts)return null;for(var e=t.contexts,r=0,a=e.length;r<a;r++){var o=e[r],l=!0,i=o.matches;for(var u in i)l=l&&i[u]===n[u];if(l)return o}return null},t.prototype.useOriginalText=function(t,n,e){return null==n?this.applyFormatting(t,n,e):this.applyFormatting(t.replace("%n",String(n)),n,e)},t.prototype.applyFormatting=function(t,n,e){var r,a;for(r in e)a=new RegExp("%{"+r+"}","g"),t=t.replace(a,e[r]);return t},t.prototype.applyToHTML=function(t){t="undefined"==typeof t?document:t;for(var e=t.querySelectorAll("[data-i18n]"),r=0;r<e.length;r++){var a=e[r],o=a.getAttribute("data-i18n"),l=a.hasAttribute("data-i18n-safe");if(!o){if(1!==a.childNodes.length){a.removeAttribute("data-i18n");continue}var i=a.childNodes[0];if(3!==i.nodeType){if(!l){a.removeAttribute("data-i18n");continue}o=a.innerHTML}else o=a.childNodes[0].nodeValue,a.setAttribute("data-i18n",o)}l?a.innerHTML=this.translate(o):n?a.innerHTML=this.translate(o).replace(/[&'`"<>]/g,function(t){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[t]}):a.textContent=this.translate(o)}},t.prototype.setLanguage=function(t,n){if(n||"undefined"==typeof localStorage||(n=localStorage),!n)throw new Error("localStorage is needed to store language");n.setItem("i18n4v.language",t)},t.prototype.selectLanguage=function(t,n,e){function r(){for(var e=0;e<a.length;e++){var r=a[0];if(t.indexOf(r)!==-1)return n(null,r)}n(new Error("preferred Language is not found"),null)}var a=[];if(e||"undefined"==typeof localStorage||(e=localStorage),e){var o=e.getItem("i18n4v.language");if(t.indexOf(o)!==-1)return n(null,o)}if("undefined"!=typeof module&&module.require)module.require("os-locale")(function(t,n){a.push(n,n.split("_")[0]),r()});else{a.push(navigator.language);var l;for(l=0;l<navigator.languages.length;l++)a.push(navigator.languages[l]);for(l=0;l<navigator.languages.length;l++)a.push(navigator.languages[l].split("_")[0]);r()}};var e=new t,r=function(){return e.translate.apply(e,arguments)};return r.translator=e,r.create=function(n){var e=new t;return null!=n&&e.add(n),e.translate.create=r.create,function(){return e.translate.apply(e,arguments)}},r});
//# sourceMappingURL=index.js.map